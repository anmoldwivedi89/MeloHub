<!DOCTYPE html>
<html lang="en">

<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <link rel="stylesheet" href="style.css">
    <link rel="stylesheet" href="utility.css">
    <title>MeloHub - Web Player: Music for everyone</title>
</head>

<body>
    <div class="container flex bg-black">
        <div class="left">
            <div class="close">
                <img width="30" src="close.svg" class="invert" alt="Close Menu">
            </div>
            <div class="home bg-grey rounded m-1 p-1">
                <div class="logo"><img src="melohub_logo.svg" alt="MeloHub Logo" class="invert"><span>MeloHub</span>
                </div>
                <ul>
                    <li id="homeBtn"><img class="invert" src="home.svg" alt="Home">Home</li>
                    <li><img class="invert" src="search.svg" alt="Search">Search</li>
                    <li id="favBtn"><svg class="invert" xmlns="http://www.w3.org/2000/svg" width="24" height="24"
                            viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2"
                            stroke-linecap="round" stroke-linejoin="round">
                            <path
                                d="M20.84 4.61a5.5 5.5 0 0 0-7.78 0L12 5.67l-1.06-1.06a5.5 5.5 0 0 0-7.78 7.78l1.06 1.06L12 21.23l8.72-8.72 1.06-1.06a5.5 5.5 0 0 0 0-7.78z">
                            </path>
                        </svg>Favorites</li>
                </ul>
            </div>

            <div class="library bg-grey rounded m-1 p-1">
                <div class="heading">
                    <img class="invert" src="melohub_logo.svg" alt="Library">
                    <span>Your Library</span>
                </div>
                <div class="songList">
                    <ul>
                    </ul>
                </div>
            </div>
        </div>

        <div class="right bg-grey rounded">
            <div class="header">
                <div class="nav">
                    <div class="hamburgerContainer">
                        <img src="hamburger.svg" class="invert hamburger" alt="Menu" />
                        <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24" width="24" height="24"
                            color="#ffffff" fill="none">
                            <path d="M15 6C15 6 9.00001 10.4189 9 12C8.99999 13.5812 15 18 15 18" stroke="currentColor"
                                stroke-width="1.5" stroke-linecap="round" stroke-linejoin="round" />
                        </svg>
                        <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24" width="24" height="24"
                            color="#ffffff" fill="none">
                            <path d="M9.00005 6C9.00005 6 15 10.4189 15 12C15 13.5812 9 18 9 18" stroke="currentColor"
                                stroke-width="1.5" stroke-linecap="round" stroke-linejoin="round" />
                        </svg>
                    </div>
                </div>
                <div class="button">
                    <div id="userProfile" style="display: none; align-items: center; gap: 15px;">
                        <span id="userName" style="color: white; font-weight: 500;"></span>
                        <button class="loginbtn" id="logoutBtn">Log out</button>
                    </div>
                    <div id="authButtons">
                        <button class="signbtn" onclick="window.location.href='signup.html'">Sign up</button>
                        <button class="loginbtn" onclick="window.location.href='login.html'">Log in</button>
                    </div>
                </div>
            </div>

            <div id="homeSection" class="spotify-playlists">
                <h1>Hindi Hits</h1>
                <div class="cardContainer" id="hindiContainer">
                    <!-- Hindi cards will be generated here -->
                </div>

                <h1 style="margin-top: 40px;">English Pop</h1>
                <div class="cardContainer" id="englishContainer">
                    <!-- English cards will be generated here -->
                </div>
            </div>

            <div id="favSection" class="spotify-playlists" style="display: none;">
                <h1>My Favorites</h1>
                <div class="cardContainer" id="favoriteContainer">
                    <!-- Favorite cards will be generated here -->
                </div>
            </div>

            <div class="playbar">
                <div class="seekbar">
                    <div class="circle"></div>
                </div>
                <div class="abovebar">
                    <div class="songinfo">Song Name Here</div>
                    <div class="songsbuttons">
                        <img id="previous" src="prevsong.svg" alt="Previous" />
                        <img id="play" src="play.svg" alt="Play" />
                        <img id="next" src="nextsong.svg" alt="Next" />
                    </div>
                    <div class="songtime">00:00 / 00:00</div>
                </div>
            </div>
        </div>
    </div>
    <script src="script.js"></script>

    <!-- Firebase Authentication -->
    <script type="module">
        // Import Firebase modules
        import { initializeApp } from 'https://www.gstatic.com/firebasejs/10.7.1/firebase-app.js';
        import { getAuth, onAuthStateChanged, signOut } from 'https://www.gstatic.com/firebasejs/10.7.1/firebase-auth.js';

        // Firebase configuration
        const firebaseConfig = {
            apiKey: "AIzaSyDHbntnls3owiym8w8m4p6o-Qf72wj45AA",
            authDomain: "spotify-94834.firebaseapp.com",
            projectId: "spotify-94834",
            storageBucket: "spotify-94834.firebasestorage.app",
            messagingSenderId: "38288570502",
            appId: "1:38288570502:web:af34f2be9f79c6356fb907"
        };

        // Initialize Firebase
        const app = initializeApp(firebaseConfig);
        const auth = getAuth(app);

        // Get UI elements
        const userProfile = document.getElementById('userProfile');
        const authButtons = document.getElementById('authButtons');
        const userName = document.getElementById('userName');
        const logoutBtn = document.getElementById('logoutBtn');

        // Check authentication state
        onAuthStateChanged(auth, (user) => {
            if (user) {
                // User is signed in
                const displayName = user.displayName || user.email.split('@')[0];
                userName.textContent = `Hello, ${displayName}`;

                // Show user profile, hide auth buttons
                userProfile.style.display = 'flex';
                authButtons.style.display = 'none';

                // Store user info in localStorage
                localStorage.setItem('spotifyUser', JSON.stringify({
                    uid: user.uid,
                    email: user.email,
                    displayName: displayName
                }));
            } else {
                // User is signed out - redirect to login
                // Comment out the next line if you want to allow browsing without login
                // window.location.href = 'login.html';

                // Show auth buttons, hide user profile
                userProfile.style.display = 'none';
                authButtons.style.display = 'block';
                localStorage.removeItem('spotifyUser');
            }
        });

        // Logout functionality
        logoutBtn.addEventListener('click', async () => {
            try {
                await signOut(auth);
                localStorage.removeItem('spotifyUser');
                window.location.href = 'login.html';
            } catch (error) {
                console.error('Logout error:', error);
                alert('Error logging out. Please try again.');
            }
        });
    </script>
</body>

</html>